"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("middleware",{

/***/ "(middleware)/./src/middleware.ts":
/*!***************************!*\
  !*** ./src/middleware.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/supabase-js */ \"(middleware)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\n\n// Define the protected routes that require authentication\nconst protectedRoutes = [\n    \"/proposals\",\n    \"/new\"\n];\nasync function middleware(request) {\n    // Check if the route is protected\n    const isProtectedRoute = protectedRoutes.some((route)=>request.nextUrl.pathname.startsWith(route));\n    // Skip middleware for non-protected routes and API routes\n    if (!isProtectedRoute || request.nextUrl.pathname.startsWith(\"/api\")) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // Get Supabase cookies from the request for server-side auth check\n    const supabaseUrl = \"https://rqwgqyhonjnzvgwxbrvh.supabase.co\" || 0;\n    const supabaseKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJxd2dxeWhvbmpuenZnd3hicnZoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDM1NDEyMjEsImV4cCI6MjA1OTExNzIyMX0.v86ffe7dc_7-NcC-i9K4UCMW4pbpTTMiAQt-U6kybB4\" || 0;\n    if (!supabaseUrl || !supabaseKey) {\n        console.error(\"Missing Supabase environment variables\");\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // Create a Supabase client with the cookies from the request\n    const supabaseClient = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__.createClient)(supabaseUrl, supabaseKey, {\n        auth: {\n            persistSession: false,\n            autoRefreshToken: false,\n            detectSessionInUrl: false\n        }\n    });\n    // Get the auth cookies from the request\n    const authCookie = request.cookies.get(\"sb-auth-token\") || request.cookies.get(\"supabase-auth-token\");\n    // If no auth cookie is present, redirect to login\n    if (!authCookie) {\n        console.log(\"No auth cookie found, redirecting to login\");\n        const redirectUrl = new URL(\"/login\", request.url);\n        redirectUrl.searchParams.set(\"redirect\", request.nextUrl.pathname);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(redirectUrl);\n    }\n    try {\n        // Try to get the session using the cookie\n        const { data: { session } } = await supabaseClient.auth.getSession();\n        // If there's no active session and the route is protected, redirect to login\n        if (!session && isProtectedRoute) {\n            console.log(\"No active session found, redirecting to login\");\n            const redirectUrl = new URL(\"/login\", request.url);\n            redirectUrl.searchParams.set(\"redirect\", request.nextUrl.pathname);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(redirectUrl);\n        }\n    } catch (error) {\n        console.error(\"Error in auth middleware:\", error);\n    }\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n}\n// Run middleware on all routes except static files and api routes\nconst config = {\n    matcher: [\n        \"/((?!_next/static|_next/image|favicon.ico|api/).*)\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vc3JjL21pZGRsZXdhcmUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUEyQztBQUVVO0FBRXJELDBEQUEwRDtBQUMxRCxNQUFNRSxrQkFBa0I7SUFBQztJQUFjO0NBQU87QUFFdkMsZUFBZUMsV0FBV0MsT0FBb0I7SUFDbkQsa0NBQWtDO0lBQ2xDLE1BQU1DLG1CQUFtQkgsZ0JBQWdCSSxJQUFJLENBQUMsQ0FBQ0MsUUFDN0NILFFBQVFJLE9BQU8sQ0FBQ0MsUUFBUSxDQUFDQyxVQUFVLENBQUNIO0lBR3RDLDBEQUEwRDtJQUMxRCxJQUFJLENBQUNGLG9CQUFvQkQsUUFBUUksT0FBTyxDQUFDQyxRQUFRLENBQUNDLFVBQVUsQ0FBQyxTQUFTO1FBQ3BFLE9BQU9WLHFEQUFZQSxDQUFDVyxJQUFJO0lBQzFCO0lBRUEsbUVBQW1FO0lBQ25FLE1BQU1DLGNBQWNDLDBDQUFvQyxJQUFJLENBQUU7SUFDOUQsTUFBTUcsY0FBY0gsa05BQXlDLElBQUksQ0FBRTtJQUVuRSxJQUFJLENBQUNELGVBQWUsQ0FBQ0ksYUFBYTtRQUNoQ0UsUUFBUUMsS0FBSyxDQUFDO1FBQ2QsT0FBT25CLHFEQUFZQSxDQUFDVyxJQUFJO0lBQzFCO0lBRUEsNkRBQTZEO0lBQzdELE1BQU1TLGlCQUFpQm5CLG1FQUFZQSxDQUFDVyxhQUFhSSxhQUFhO1FBQzVESyxNQUFNO1lBQ0pDLGdCQUFnQjtZQUNoQkMsa0JBQWtCO1lBQ2xCQyxvQkFBb0I7UUFDdEI7SUFDRjtJQUVBLHdDQUF3QztJQUN4QyxNQUFNQyxhQUNKckIsUUFBUXNCLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLG9CQUNwQnZCLFFBQVFzQixPQUFPLENBQUNDLEdBQUcsQ0FBQztJQUV0QixrREFBa0Q7SUFDbEQsSUFBSSxDQUFDRixZQUFZO1FBQ2ZQLFFBQVFVLEdBQUcsQ0FBQztRQUNaLE1BQU1DLGNBQWMsSUFBSUMsSUFBSSxVQUFVMUIsUUFBUTJCLEdBQUc7UUFDakRGLFlBQVlHLFlBQVksQ0FBQ0MsR0FBRyxDQUFDLFlBQVk3QixRQUFRSSxPQUFPLENBQUNDLFFBQVE7UUFDakUsT0FBT1QscURBQVlBLENBQUNrQyxRQUFRLENBQUNMO0lBQy9CO0lBRUEsSUFBSTtRQUNGLDBDQUEwQztRQUMxQyxNQUFNLEVBQ0pNLE1BQU0sRUFBRUMsT0FBTyxFQUFFLEVBQ2xCLEdBQUcsTUFBTWhCLGVBQWVDLElBQUksQ0FBQ2dCLFVBQVU7UUFFeEMsNkVBQTZFO1FBQzdFLElBQUksQ0FBQ0QsV0FBVy9CLGtCQUFrQjtZQUNoQ2EsUUFBUVUsR0FBRyxDQUFDO1lBQ1osTUFBTUMsY0FBYyxJQUFJQyxJQUFJLFVBQVUxQixRQUFRMkIsR0FBRztZQUNqREYsWUFBWUcsWUFBWSxDQUFDQyxHQUFHLENBQUMsWUFBWTdCLFFBQVFJLE9BQU8sQ0FBQ0MsUUFBUTtZQUNqRSxPQUFPVCxxREFBWUEsQ0FBQ2tDLFFBQVEsQ0FBQ0w7UUFDL0I7SUFDRixFQUFFLE9BQU9WLE9BQU87UUFDZEQsUUFBUUMsS0FBSyxDQUFDLDZCQUE2QkE7SUFDN0M7SUFFQSxPQUFPbkIscURBQVlBLENBQUNXLElBQUk7QUFDMUI7QUFFQSxrRUFBa0U7QUFDM0QsTUFBTTJCLFNBQVM7SUFDcEJDLFNBQVM7UUFBQztLQUFxRDtBQUNqRSxFQUFFIiwic291cmNlcyI6WyIvVXNlcnMvcnVkaWhpbmRzL2NvZGUvbGFuZ2dyYXBoLWFnZW50L2FwcHMvd2ViL3NyYy9taWRkbGV3YXJlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xuaW1wb3J0IHR5cGUgeyBOZXh0UmVxdWVzdCB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xuaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSBcIkBzdXBhYmFzZS9zdXBhYmFzZS1qc1wiO1xuXG4vLyBEZWZpbmUgdGhlIHByb3RlY3RlZCByb3V0ZXMgdGhhdCByZXF1aXJlIGF1dGhlbnRpY2F0aW9uXG5jb25zdCBwcm90ZWN0ZWRSb3V0ZXMgPSBbXCIvcHJvcG9zYWxzXCIsIFwiL25ld1wiXTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG1pZGRsZXdhcmUocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgLy8gQ2hlY2sgaWYgdGhlIHJvdXRlIGlzIHByb3RlY3RlZFxuICBjb25zdCBpc1Byb3RlY3RlZFJvdXRlID0gcHJvdGVjdGVkUm91dGVzLnNvbWUoKHJvdXRlKSA9PlxuICAgIHJlcXVlc3QubmV4dFVybC5wYXRobmFtZS5zdGFydHNXaXRoKHJvdXRlKVxuICApO1xuXG4gIC8vIFNraXAgbWlkZGxld2FyZSBmb3Igbm9uLXByb3RlY3RlZCByb3V0ZXMgYW5kIEFQSSByb3V0ZXNcbiAgaWYgKCFpc1Byb3RlY3RlZFJvdXRlIHx8IHJlcXVlc3QubmV4dFVybC5wYXRobmFtZS5zdGFydHNXaXRoKFwiL2FwaVwiKSkge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UubmV4dCgpO1xuICB9XG5cbiAgLy8gR2V0IFN1cGFiYXNlIGNvb2tpZXMgZnJvbSB0aGUgcmVxdWVzdCBmb3Igc2VydmVyLXNpZGUgYXV0aCBjaGVja1xuICBjb25zdCBzdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCB8fCBcIlwiO1xuICBjb25zdCBzdXBhYmFzZUtleSA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIHx8IFwiXCI7XG5cbiAgaWYgKCFzdXBhYmFzZVVybCB8fCAhc3VwYWJhc2VLZXkpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiTWlzc2luZyBTdXBhYmFzZSBlbnZpcm9ubWVudCB2YXJpYWJsZXNcIik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5uZXh0KCk7XG4gIH1cblxuICAvLyBDcmVhdGUgYSBTdXBhYmFzZSBjbGllbnQgd2l0aCB0aGUgY29va2llcyBmcm9tIHRoZSByZXF1ZXN0XG4gIGNvbnN0IHN1cGFiYXNlQ2xpZW50ID0gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZUtleSwge1xuICAgIGF1dGg6IHtcbiAgICAgIHBlcnNpc3RTZXNzaW9uOiBmYWxzZSwgLy8gRG9uJ3QgcGVyc2lzdCBpbiBtaWRkbGV3YXJlIGNvbnRleHRcbiAgICAgIGF1dG9SZWZyZXNoVG9rZW46IGZhbHNlLFxuICAgICAgZGV0ZWN0U2Vzc2lvbkluVXJsOiBmYWxzZSxcbiAgICB9LFxuICB9KTtcblxuICAvLyBHZXQgdGhlIGF1dGggY29va2llcyBmcm9tIHRoZSByZXF1ZXN0XG4gIGNvbnN0IGF1dGhDb29raWUgPVxuICAgIHJlcXVlc3QuY29va2llcy5nZXQoXCJzYi1hdXRoLXRva2VuXCIpIHx8XG4gICAgcmVxdWVzdC5jb29raWVzLmdldChcInN1cGFiYXNlLWF1dGgtdG9rZW5cIik7XG5cbiAgLy8gSWYgbm8gYXV0aCBjb29raWUgaXMgcHJlc2VudCwgcmVkaXJlY3QgdG8gbG9naW5cbiAgaWYgKCFhdXRoQ29va2llKSB7XG4gICAgY29uc29sZS5sb2coXCJObyBhdXRoIGNvb2tpZSBmb3VuZCwgcmVkaXJlY3RpbmcgdG8gbG9naW5cIik7XG4gICAgY29uc3QgcmVkaXJlY3RVcmwgPSBuZXcgVVJMKFwiL2xvZ2luXCIsIHJlcXVlc3QudXJsKTtcbiAgICByZWRpcmVjdFVybC5zZWFyY2hQYXJhbXMuc2V0KFwicmVkaXJlY3RcIiwgcmVxdWVzdC5uZXh0VXJsLnBhdGhuYW1lKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KHJlZGlyZWN0VXJsKTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgLy8gVHJ5IHRvIGdldCB0aGUgc2Vzc2lvbiB1c2luZyB0aGUgY29va2llXG4gICAgY29uc3Qge1xuICAgICAgZGF0YTogeyBzZXNzaW9uIH0sXG4gICAgfSA9IGF3YWl0IHN1cGFiYXNlQ2xpZW50LmF1dGguZ2V0U2Vzc2lvbigpO1xuXG4gICAgLy8gSWYgdGhlcmUncyBubyBhY3RpdmUgc2Vzc2lvbiBhbmQgdGhlIHJvdXRlIGlzIHByb3RlY3RlZCwgcmVkaXJlY3QgdG8gbG9naW5cbiAgICBpZiAoIXNlc3Npb24gJiYgaXNQcm90ZWN0ZWRSb3V0ZSkge1xuICAgICAgY29uc29sZS5sb2coXCJObyBhY3RpdmUgc2Vzc2lvbiBmb3VuZCwgcmVkaXJlY3RpbmcgdG8gbG9naW5cIik7XG4gICAgICBjb25zdCByZWRpcmVjdFVybCA9IG5ldyBVUkwoXCIvbG9naW5cIiwgcmVxdWVzdC51cmwpO1xuICAgICAgcmVkaXJlY3RVcmwuc2VhcmNoUGFyYW1zLnNldChcInJlZGlyZWN0XCIsIHJlcXVlc3QubmV4dFVybC5wYXRobmFtZSk7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KHJlZGlyZWN0VXJsKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGluIGF1dGggbWlkZGxld2FyZTpcIiwgZXJyb3IpO1xuICB9XG5cbiAgcmV0dXJuIE5leHRSZXNwb25zZS5uZXh0KCk7XG59XG5cbi8vIFJ1biBtaWRkbGV3YXJlIG9uIGFsbCByb3V0ZXMgZXhjZXB0IHN0YXRpYyBmaWxlcyBhbmQgYXBpIHJvdXRlc1xuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgbWF0Y2hlcjogW1wiLygoPyFfbmV4dC9zdGF0aWN8X25leHQvaW1hZ2V8ZmF2aWNvbi5pY298YXBpLykuKilcIl0sXG59O1xuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImNyZWF0ZUNsaWVudCIsInByb3RlY3RlZFJvdXRlcyIsIm1pZGRsZXdhcmUiLCJyZXF1ZXN0IiwiaXNQcm90ZWN0ZWRSb3V0ZSIsInNvbWUiLCJyb3V0ZSIsIm5leHRVcmwiLCJwYXRobmFtZSIsInN0YXJ0c1dpdGgiLCJuZXh0Iiwic3VwYWJhc2VVcmwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwic3VwYWJhc2VLZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsImNvbnNvbGUiLCJlcnJvciIsInN1cGFiYXNlQ2xpZW50IiwiYXV0aCIsInBlcnNpc3RTZXNzaW9uIiwiYXV0b1JlZnJlc2hUb2tlbiIsImRldGVjdFNlc3Npb25JblVybCIsImF1dGhDb29raWUiLCJjb29raWVzIiwiZ2V0IiwibG9nIiwicmVkaXJlY3RVcmwiLCJVUkwiLCJ1cmwiLCJzZWFyY2hQYXJhbXMiLCJzZXQiLCJyZWRpcmVjdCIsImRhdGEiLCJzZXNzaW9uIiwiZ2V0U2Vzc2lvbiIsImNvbmZpZyIsIm1hdGNoZXIiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(middleware)/./src/middleware.ts\n");

/***/ })

});